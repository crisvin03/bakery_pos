{% extends 'core/base.html' %}
{% load static %}
{% block content %}

<style>
  :root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --card-shadow: 0 20px 40px rgba(16,24,40,.08);
    --border-color: rgba(16,24,40,.08);
  }

  .page-head { 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    gap: 1.5rem; 
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-radius: 20px;
    border: 1px solid var(--border-color);
  }

  .page-head h2 {
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
    letter-spacing: -0.025em;
  }

  .card-elevated {
    border: 1px solid var(--border-color);
    border-radius: 20px;
    box-shadow: var(--card-shadow);
    overflow: hidden;
  }

  .avatar-info {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--primary-gradient);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    font-weight: 700;
    margin-right: 1rem;
  }

  .login-item {
    padding: 1rem 1.5rem;
    border-bottom: 1px solid #e5e7eb;
    transition: background 0.2s;
  }

  .login-item:hover {
    background: #f9fafb;
  }

  .login-item:last-child {
    border-bottom: none;
  }

  .badge-status {
    padding: 0.35rem 0.75rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
  }

  .badge-active {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
  }

  .badge-logged-out {
    background: #e5e7eb;
    color: #6b7280;
  }

  .empty-state {
    text-align: center;
    padding: 3rem;
    color: #64748b;
  }

  .empty-state svg {
    width: 80px;
    height: 80px;
    margin-bottom: 1rem;
    opacity: 0.5;
  }
</style>

<div class="page-head">
  <div class="d-flex align-items-center">
    <a href="{% url 'cashier_list' %}" class="btn btn-link text-decoration-none me-3">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
      </svg>
    </a>
    <div>
      <h2 class="h3 mb-1">üîê Login History</h2>
      <div class="text-secondary">View login activity for {{ cashier.get_full_name|default:cashier.username }}</div>
    </div>
  </div>
</div>

<div class="card card-elevated">
  <div class="card-body p-0">
    {% if login_history %}
      <div class="p-3 border-bottom bg-light">
        <div class="d-flex align-items-center">
          <div class="avatar-info">
            {{ cashier.username|slice:":1"|upper }}
          </div>
          <div>
            <h5 class="mb-0">{{ cashier.get_full_name|default:cashier.username }}</h5>
            <p class="text-muted small mb-0">@{{ cashier.username }} ‚Ä¢ {{ login_history|length }} login record{{ login_history|length|pluralize }}</p>
          </div>
        </div>
      </div>

      <div>
        {% for login in login_history %}
          <div class="login-item">
            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex align-items-center">
                <div>
                  <div class="fw-semibold">
                    {% if login.logout_time %}
                      <span class="badge-status badge-logged-out">Logged Out</span>
                    {% else %}
                      <span class="badge-status badge-active">Active Session</span>
                    {% endif %}
                  </div>
                  <div class="text-muted small mt-1">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="me-1" style="opacity: 0.6;">
                      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Login: {{ login.login_time|date:"M d, Y H:i:s" }}
                    {% if login.logout_time %}
                      <span class="ms-3">Logout: {{ login.logout_time|date:"M d, Y H:i:s" }}</span>
                    {% endif %}
                  </div>
                </div>
              </div>
              <div class="text-end">
                {% if login.ip_address %}
                  <div class="text-muted small">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" class="me-1" style="opacity: 0.6;">
                      <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    {{ login.ip_address }}
                  </div>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
        </svg>
        <h5 class="mt-3">No Login History</h5>
        <p class="text-muted">This cashier hasn't logged in yet.</p>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}

